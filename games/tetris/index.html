<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="referrer" content="no-referrer-when-downgrade">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Neon Tetris</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #000;
      font-family: 'Press Start 2P', cursive;
      touch-action: manipulation;
      overflow: hidden;
      color: #fff;
    }

    #game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      height: 100%;
      max-width: 100vw;
      padding: 10px;
      box-sizing: border-box;
    }

    #game-board {
      width: 100%;
      height: calc(100vh - 120px);
      max-width: none;
      border: 2px solid #0ff;
      background-color: rgba(0, 0, 0, 0.8);
      position: relative;
      box-shadow: 0 0 20px #0ff;
      border-radius: 5px;
    }

    .tetromino {
      position: absolute;
      box-sizing: border-box;
      border: 1px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 0 5px currentColor;
    }

    #score {
      margin-bottom: 10px;
      font-size: 16px;
      text-shadow: 0 0 5px #0ff;
    }

    #start-button,
    #pause-button {
      margin-top: 10px;
      padding: 8px 16px;
      font-size: 14px;
      font-family: 'Press Start 2P', cursive;
      background-color: #0ff;
      color: #000;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px #0ff;
    }

    #start-button:hover,
    #pause-button:hover {
      background-color: #fff;
      box-shadow: 0 0 20px #fff;
    }

    #button-container {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      width: 100%;
    }

    #button-container button {
      margin: 0 10px;
    }

    #mobile-controls {
      display: none;
      justify-content: center;
      width: 100%;
      margin-top: 10px;
    }

    @media (max-width: 550px) {
      #mobile-controls {
        display: flex;
      }
    }

    .control-button {
      width: 40px;
      height: 40px;
      font-size: 16px;
      font-family: 'Press Start 2P', cursive;
      background-color: #0ff;
      color: #000;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px #0ff;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0;
      margin: 0 5px;
    }

    .control-button:hover,
    .control-button:active {
      background-color: #fff;
      box-shadow: 0 0 20px #fff;
    }

    #mobile-controls-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    @keyframes neon-glow {
      0% {
        box-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 15px #0ff, 0 0 20px #0ff;
      }

      50% {
        box-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff, 0 0 40px #0ff;
      }

      100% {
        box-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 15px #0ff, 0 0 20px #0ff;
      }
    }

    #game-board {
      animation: neon-glow 2s infinite;
    }

    @media (max-height: 600px) {
      #game-board {
        height: calc(100vh - 150px);
      }

      #score {
        font-size: 14px;
      }

      #start-button,
      #pause-button {
        font-size: 12px;
        padding: 6px 12px;
      }

      .control-button {
        width: 40px;
        height: 40px;
        font-size: 16px;
      }
    }

    @media (max-width: 550px) {
      #game-container {
        padding: 5px;
      }
    }
  </style>
</head>

<body>
  <div id="game-container">
    <div id="score">Score: 0</div>
    <div id="game-board"></div>
    <div id="button-container">
      <button id="start-button">Start Game</button>
      <button id="pause-button" style="display: none;">Pause</button>
    </div>
    <div id="mobile-controls">
      <div id="mobile-controls-container">
        <button class="control-button" id="left-button">←</button>
        <button class="control-button" id="rotate-button">↻</button>
        <button class="control-button" id="down-button">↓</button>
        <button class="control-button" id="right-button">→</button>
      </div>
    </div>
  </div>
  <script>
    (function() {
      let GG_ALL_GAME_CONFIG = {
        boardWidth: 10, // Number of columns in the game board
        boardHeight: 20, // Number of rows in the game board
        initialSpeed: 1000, // Initial speed of tetromino fall in milliseconds
        speedIncrease: 50, // Amount to decrease fall speed by for each level
        colors: ['#00FFFF', '#0000FF', '#FFA500', '#FFFF00', '#00FF00', '#FF00FF', '#FF0000'], // Neon colors for tetrominoes
        scorePerLine: 100, // Score awarded for each completed line
        minBlockSize: 15, // Minimum size of each tetromino block in pixels
      };
      // Function to calculate and update board dimensions
      function updateBoardDimensions() {
        const gameboardElement = document.getElementById('game-board');
        const containerElement = document.getElementById('game-container');
        const maxWidth = containerElement.clientWidth;
        const maxHeight = window.innerHeight - 120; // Adjust for score and buttons
        const blockSize = Math.max(
          GG_ALL_GAME_CONFIG.minBlockSize,
          Math.min(
            Math.floor(maxWidth / GG_ALL_GAME_CONFIG.boardWidth),
            Math.floor(maxHeight / GG_ALL_GAME_CONFIG.boardHeight)
          )
        );
        const newWidth = GG_ALL_GAME_CONFIG.boardWidth * blockSize;
        const newHeight = GG_ALL_GAME_CONFIG.boardHeight * blockSize;
        gameboardElement.style.width = `${newWidth}px`;
        gameboardElement.style.height = `${newHeight}px`;
        gameboardElement.style.fontSize = `${blockSize}px`;
      }
      let gameBoard = [];
      let currentTetromino;
      let score = 0;
      let gameInterval;
      let gameStarted = false;
      let gamePaused = false;
      const gameboardElement = document.getElementById('game-board');
      const scoreElement = document.getElementById('score');
      const startButton = document.getElementById('start-button');
      const pauseButton = document.getElementById('pause-button');

      function initializeBoard() {
        gameBoard = [];
        for (let y = 0; y < GG_ALL_GAME_CONFIG.boardHeight; y++) {
          gameBoard[y] = [];
          for (let x = 0; x < GG_ALL_GAME_CONFIG.boardWidth; x++) {
            gameBoard[y][x] = 0;
          }
        }
      }

      function createTetromino() {
        const shapes = [{
            shape: [
              [1, 1, 1, 1]
            ],
            color: GG_ALL_GAME_CONFIG.colors[0]
          },
          {
            shape: [
              [1, 1],
              [1, 1]
            ],
            color: GG_ALL_GAME_CONFIG.colors[3]
          },
          {
            shape: [
              [1, 1, 1],
              [0, 1, 0]
            ],
            color: GG_ALL_GAME_CONFIG.colors[5]
          },
          {
            shape: [
              [1, 1, 1],
              [1, 0, 0]
            ],
            color: GG_ALL_GAME_CONFIG.colors[1]
          },
          {
            shape: [
              [1, 1, 1],
              [0, 0, 1]
            ],
            color: GG_ALL_GAME_CONFIG.colors[2]
          },
          {
            shape: [
              [1, 1, 0],
              [0, 1, 1]
            ],
            color: GG_ALL_GAME_CONFIG.colors[4]
          },
          {
            shape: [
              [0, 1, 1],
              [1, 1, 0]
            ],
            color: GG_ALL_GAME_CONFIG.colors[6]
          }
        ];
        const randomTetrominoType = shapes[Math.floor(Math.random() * shapes.length)];
        return {
          shape: randomTetrominoType.shape,
          x: Math.floor(GG_ALL_GAME_CONFIG.boardWidth / 2) - Math.floor(randomTetrominoType.shape[0].length / 2),
          y: 0,
          color: randomTetrominoType.color
        };
      }

      function drawTetromino() {
        const blockSize = calculateBlockSize();
        currentTetromino.shape.forEach((row, y) => {
          row.forEach((value, x) => {
            if (value) {
              const block = document.createElement('div');
              block.classList.add('tetromino');
              block.style.backgroundColor = currentTetromino.color;
              block.style.width = `${blockSize}px`;
              block.style.height = `${blockSize}px`;
              block.style.left = `${(currentTetromino.x + x) * blockSize}px`;
              block.style.top = `${(currentTetromino.y + y) * blockSize}px`;
              block.style.boxShadow = `0 0 5px ${currentTetromino.color}, 0 0 10px ${currentTetromino.color}`;
              gameboardElement.appendChild(block);
            }
          });
        });
      }

      function calculateBlockSize() {
        const gameboardElement = document.getElementById('game-board');
        const boardWidth = gameboardElement.clientWidth;
        const boardHeight = gameboardElement.clientHeight;
        return Math.max(
          GG_ALL_GAME_CONFIG.minBlockSize,
          Math.min(
            Math.floor(boardWidth / GG_ALL_GAME_CONFIG.boardWidth),
            Math.floor(boardHeight / GG_ALL_GAME_CONFIG.boardHeight)
          )
        );
      }

      function moveTetromino(dx, dy) {
        currentTetromino.x += dx;
        currentTetromino.y += dy;
        if (collision()) {
          currentTetromino.x -= dx;
          currentTetromino.y -= dy;
          if (dy > 0) {
            mergeTetromino();
            checkLines();
            currentTetromino = createTetromino();
            if (collision()) {
              gameOver();
            }
          }
        }
        updateGame();
      }

      function rotateTetromino() {
        const rotated = currentTetromino.shape[0].map((_, index) =>
          currentTetromino.shape.map(row => row[index]).reverse()
        );
        const previousShape = currentTetromino.shape;
        currentTetromino.shape = rotated;
        if (collision()) {
          currentTetromino.shape = previousShape;
        }
        updateGame();
      }

      function collision() {
        return currentTetromino.shape.some((row, dy) =>
          row.some((value, dx) =>
            value &&
            (currentTetromino.y + dy >= GG_ALL_GAME_CONFIG.boardHeight ||
              currentTetromino.x + dx < 0 ||
              currentTetromino.x + dx >= GG_ALL_GAME_CONFIG.boardWidth ||
              gameBoard[currentTetromino.y + dy][currentTetromino.x + dx])
          )
        );
      }

      function mergeTetromino() {
        currentTetromino.shape.forEach((row, y) => {
          row.forEach((value, x) => {
            if (value) {
              gameBoard[currentTetromino.y + y][currentTetromino.x + x] = currentTetromino.color;
            }
          });
        });
      }

      function checkLines() {
        let linesCleared = 0;
        for (let y = GG_ALL_GAME_CONFIG.boardHeight - 1; y >= 0; y--) {
          if (gameBoard[y].every(cell => cell)) {
            linesCleared++;
          } else if (linesCleared > 0) {
            gameBoard[y + linesCleared] = gameBoard[y];
          }
        }
        if (linesCleared > 0) {
          for (let y = 0; y < linesCleared; y++) {
            gameBoard[y] = new Array(GG_ALL_GAME_CONFIG.boardWidth).fill(0);
          }
          score += linesCleared * GG_ALL_GAME_CONFIG.scorePerLine;
          scoreElement.textContent = `Score: ${score}`;
          increaseSpeed();
        }
      }

      function increaseSpeed() {
        clearInterval(gameInterval);
        const speed = Math.max(100, GG_ALL_GAME_CONFIG.initialSpeed - Math.floor(score / 1000) * GG_ALL_GAME_CONFIG.speedIncrease);
        gameInterval = setInterval(gameLoop, speed);
      }

      function updateGame() {
        gameboardElement.innerHTML = '';
        const blockSize = calculateBlockSize();
        gameBoard.forEach((row, y) => {
          row.forEach((color, x) => {
            if (color) {
              const block = document.createElement('div');
              block.classList.add('tetromino');
              block.style.backgroundColor = color;
              block.style.width = `${blockSize}px`;
              block.style.height = `${blockSize}px`;
              block.style.left = `${x * blockSize}px`;
              block.style.top = `${y * blockSize}px`;
              block.style.boxShadow = `0 0 5px ${color}, 0 0 10px ${color}`;
              gameboardElement.appendChild(block);
            }
          });
        });
        drawTetromino();
      }

      function calculateBlockSize() {
        const gameboardElement = document.getElementById('game-board');
        return Math.floor(gameboardElement.clientWidth / GG_ALL_GAME_CONFIG.boardWidth);
      }

      function resizeGame() {
        updateBoardDimensions();
        if (gameStarted) {
          updateGame();
        }
        updateMobileControls();
      }
      window.addEventListener('resize', () => {
        updateBoardDimensions();
        if (gameStarted) {
          updateGame();
        }
        updateMobileControls();
      });
      // Call updateBoardDimensions on initial load
      updateBoardDimensions();

      function updateMobileControls() {
        const mobileControls = document.getElementById('mobile-controls');
        if (window.innerWidth <= 550) {
          mobileControls.style.display = 'flex';
        } else {
          mobileControls.style.display = 'none';
        }
      }
      // Call updateMobileControls on initial load
      updateMobileControls();

      function gameLoop() {
        moveTetromino(0, 1);
      }

      function gameOver() {
        clearInterval(gameInterval);
        alert(`Game Over! Your score: ${score}`);
        gameStarted = false;
        startButton.textContent = 'Start Game';
        startButton.style.display = 'inline-block';
        pauseButton.style.display = 'none';
      }

      function startGame() {
        if (!gameStarted) {
          updateBoardDimensions();
          initializeBoard();
          score = 0;
          scoreElement.textContent = 'Score: 0';
          currentTetromino = createTetromino();
          gameInterval = setInterval(gameLoop, GG_ALL_GAME_CONFIG.initialSpeed);
          gameStarted = true;
          gamePaused = false;
          startButton.style.display = 'none';
          pauseButton.style.display = 'inline-block';
          pauseButton.textContent = 'Pause';
          updateGame();
        } else if (gamePaused) {
          if (confirm('Are you sure you want to reset the game? Your current progress will be lost.')) {
            clearInterval(gameInterval);
            gameStarted = false;
            gamePaused = false;
            startButton.textContent = 'Start Game';
            startButton.style.display = 'inline-block';
            pauseButton.style.display = 'none';
            pauseButton.textContent = 'Pause';
            initializeBoard();
            score = 0;
            scoreElement.textContent = 'Score: 0';
            updateGame();
          }
        }
      }

      function pauseGame() {
        if (!gameStarted) return;
        if (gamePaused) {
          gameInterval = setInterval(gameLoop, GG_ALL_GAME_CONFIG.initialSpeed);
          gamePaused = false;
          pauseButton.textContent = 'Pause';
          startButton.style.display = 'none';
        } else {
          clearInterval(gameInterval);
          gamePaused = true;
          pauseButton.textContent = 'Resume';
          startButton.textContent = 'Reset Game';
          startButton.style.display = 'inline-block';
        }
      }
      startButton.addEventListener('click', startGame);
      pauseButton.addEventListener('click', pauseGame);
      document.addEventListener('keydown', (e) => {
        if (!gameStarted || gamePaused) return;
        switch (e.key) {
          case 'ArrowLeft':
            moveTetromino(-1, 0);
            break;
          case 'ArrowRight':
            moveTetromino(1, 0);
            break;
          case 'ArrowDown':
            moveTetromino(0, 1);
            break;
          case 'ArrowUp':
            rotateTetromino();
            break;
        }
      });
      // Mobile controls
      document.getElementById('left-button').addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (gameStarted && !gamePaused) moveTetromino(-1, 0);
      });
      document.getElementById('right-button').addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (gameStarted && !gamePaused) moveTetromino(1, 0);
      });
      document.getElementById('down-button').addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (gameStarted && !gamePaused) moveTetromino(0, 1);
      });
      document.getElementById('rotate-button').addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (gameStarted && !gamePaused) rotateTetromino();
      });
      // Prevent scrolling when touching the canvas
      document.body.addEventListener("touchstart", function(e) {
        if (e.target.id === 'game-board' || e.target.classList.contains('control-button')) {
          e.preventDefault();
        }
      }, {
        passive: false
      });
      document.body.addEventListener("touchend", function(e) {
        if (e.target.id === 'game-board' || e.target.classList.contains('control-button')) {
          e.preventDefault();
        }
      }, {
        passive: false
      });
      document.body.addEventListener("touchmove", function(e) {
        if (e.target.id === 'game-board' || e.target.classList.contains('control-button')) {
          e.preventDefault();
        }
      }, {
        passive: false
      });
      // Add click events for non-touch devices
      document.getElementById('left-button').addEventListener('click', () => {
        if (gameStarted && !gamePaused) moveTetromino(-1, 0);
      });
      document.getElementById('right-button').addEventListener('click', () => {
        if (gameStarted && !gamePaused) moveTetromino(1, 0);
      });
      document.getElementById('down-button').addEventListener('click', () => {
        if (gameStarted && !gamePaused) moveTetromino(0, 1);
      });
      document.getElementById('rotate-button').addEventListener('click', () => {
        if (gameStarted && !gamePaused) rotateTetromino();
      });
      initializeBoard();
    })();
  </script>

</body>

</html>